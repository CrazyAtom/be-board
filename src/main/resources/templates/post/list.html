<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>게시판</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container py-5">
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>📃 게시판</h1>
    <a href="/posts/new" class="btn btn-success">✏️ 글 작성</a>
</div>

<ul id="post-list" class="list-group">
    <!-- JS로 게시글 목록을 렌더링합니다 -->
</ul>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const list = document.getElementById('post-list');

        fetch('/api/posts')
            .then(res => {
                if (!res.ok) {
                    throw new Error('서버 응답 오류');
                }
                return res.json();
            })
            .then(posts => {
                if (!posts || posts.length === 0) {
                    list.innerHTML = '<li class="list-group-item text-muted">게시글이 없습니다.</li>';
                    return;
                }

                list.innerHTML = ''; // 기존 내용 초기화
                posts.forEach(post => {
                    const item = document.createElement('li');
                    item.className = 'list-group-item d-flex justify-content-between align-items-center';

                    const link = document.createElement('a');
                    link.href = `/posts/${post.id}`;
                    link.textContent = post.title;
                    link.className = 'text-decoration-none';

                    item.appendChild(link);
                    list.appendChild(item);
                });
            })
            .catch(error => {
                console.error('게시글 목록 불러오기 실패:', error);
                list.innerHTML = '<li class="list-group-item text-danger">게시글 목록을 불러오는데 실패했습니다.</li>';
            });
    });
</script>
</body>
</html>
